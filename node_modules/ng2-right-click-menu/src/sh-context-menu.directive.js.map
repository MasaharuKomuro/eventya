{"version":3,"file":"sh-context-menu.directive.js","sourceRoot":"","sources":["../../src/sh-context-menu.directive.ts"],"names":[],"mappings":"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","sourcesContent":["import { ShContextService } from './sh-context-service';\nimport { Directive, Input, HostListener, ViewContainerRef, OnInit, ComponentFactoryResolver, ComponentRef, ElementRef } from \"@angular/core\";\n\nimport { ShContextOverlayComponent } from './sh-context-overlay.component';\nimport { IShContextMenuItem } from \"./sh-context-item\";\nimport { ShContextMenuComponent, ShContextPosition } from \"./sh-context-menu.component\";\nimport { IShContextOptions } from './sh-context-options';\n\n@Directive({\n  selector: '[sh-context]'\n})\nexport class ShContextMenuDirective {\n  @Input('sh-context') menuItems: IShContextMenuItem[];\n  @Input('sh-data-context') dataContext: any;\n  @Input('sh-options') options: IShContextOptions;\n\n  ctxComponent: ComponentRef<ShContextMenuComponent>;\n  overlayComponent: ComponentRef<ShContextOverlayComponent>;\n\n  constructor(\n    private viewRef: ViewContainerRef,\n    private resolver: ComponentFactoryResolver,\n    private ctxService: ShContextService\n  ) { }\n\n  @HostListener('contextmenu', ['$event'])\n  onClick(event: MouseEvent) {\n    this.options = this.ctxService.setOptions(this.options);\n\n    this.closeMenu();\n    this.ctxComponent = this.createContextComponent();\n    this.overlayComponent = this.createOverlayComponent();\n\n    this.registerBindings();\n    this.registerEvents();\n    this.setLocation(event);\n\n    return false;\n  }\n\n  registerEvents() {\n    this.ctxComponent.instance.onClose.subscribe(() => {\n      this.closeMenu()\n    });\n\n    this.overlayComponent.instance.onClick.subscribe(() => { this.closeMenu() });\n  }\n\n  registerBindings() {\n    this.ctxComponent.instance.items = this.menuItems;\n    this.ctxComponent.instance.dataContext = this.dataContext;\n  }\n\n  createContextComponent(): ComponentRef<ShContextMenuComponent> {\n    let shContextMenuFactory = this.resolver.resolveComponentFactory(ShContextMenuComponent);\n    let shContextComponentRef = this.viewRef.createComponent(shContextMenuFactory);\n\n    return shContextComponentRef;\n  }\n\n  createOverlayComponent(): ComponentRef<ShContextOverlayComponent> {\n    let shContextOverlayFactory = this.resolver.resolveComponentFactory(ShContextOverlayComponent);\n    let shContextOverlayRef = this.viewRef.createComponent(shContextOverlayFactory);\n\n    return shContextOverlayRef;\n  }\n\n  setLocation(event: MouseEvent) {\n    let { clientX, clientY } = event;\n\n    let position: ShContextPosition = {\n      top: clientY,\n      left: clientX\n    };\n\n    this.ctxComponent.instance.position = position;\n  }\n\n  closeMenu() {\n    this.viewRef.clear();\n  }\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}